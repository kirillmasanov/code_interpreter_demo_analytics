/* ── Reset & Base ──────────────────────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
[hidden] { display: none !important; }

:root {
  --blue-600: #0077FF;
  --blue-700: #005FCC;
  --blue-100: #E6F1FF;
  --blue-50:  #F0F7FF;
  --gray-900: #1A1A2E;
  --gray-800: #2D2D3F;
  --gray-700: #3D3D50;
  --gray-500: #6B7280;
  --gray-400: #9CA3AF;
  --gray-300: #D1D5DB;
  --gray-200: #E5E7EB;
  --gray-100: #F3F4F6;
  --gray-50:  #F9FAFB;
  --white:    #FFFFFF;
  --green-600:#16A34A;
  --green-100:#DCFCE7;
  --red-600:  #DC2626;
  --red-100:  #FEE2E2;
  --yellow-600:#CA8A04;
  --yellow-100:#FEF9C3;
  --radius:   8px;
  --radius-lg:12px;
  --shadow:   0 1px 3px rgba(0,0,0,.08), 0 1px 2px rgba(0,0,0,.04);
  --shadow-md:0 4px 12px rgba(0,0,0,.08), 0 2px 4px rgba(0,0,0,.04);
  --transition: 150ms ease;
}

html { font-size: 16px; }
body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: var(--gray-50);
  color: var(--gray-900);
  line-height: 1.6;
  min-height: 100vh;
}

/* ── Header ───────────────────────────────────────────── */
.header {
  background: var(--gray-900);
  color: var(--white);
  height: 56px;
  display: flex;
  align-items: center;
}
.header__inner {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 24px;
  display: flex;
  align-items: center;
}
.header__logo {
  display: flex;
  align-items: center;
  gap: 12px;
}
.header__title {
  font-weight: 600;
  font-size: 15px;
  letter-spacing: -0.01em;
}
.header__badge {
  background: var(--blue-600);
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 500;
  margin-left: 4px;
}

/* ── Steps Bar ────────────────────────────────────────── */
.steps-bar {
  background: var(--white);
  border-bottom: 1px solid var(--gray-200);
  padding: 16px 0;
}
.steps-bar__inner {
  max-width: 600px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: center;
}
.step {
  display: flex;
  align-items: center;
  gap: 8px;
  background: none;
  border: none;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: var(--radius);
  transition: var(--transition);
  font-family: inherit;
}
.step:hover { background: var(--gray-100); }
.step__num {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 13px;
  font-weight: 600;
  background: var(--gray-200);
  color: var(--gray-500);
  transition: var(--transition);
}
.step.active .step__num,
.step.completed .step__num {
  background: var(--blue-600);
  color: var(--white);
}
.step.completed .step__num {
  background: var(--green-600);
}
.step__label {
  font-size: 13px;
  font-weight: 500;
  color: var(--gray-500);
  transition: var(--transition);
}
.step.active .step__label { color: var(--gray-900); }
.step.completed .step__label { color: var(--green-600); }
.step__line {
  width: 40px;
  height: 2px;
  background: var(--gray-200);
  margin: 0 4px;
  border-radius: 1px;
  transition: var(--transition);
}
.step__line.active { background: var(--blue-600); }
.step__line.completed { background: var(--green-600); }

/* ── Main ─────────────────────────────────────────────── */
.main {
  max-width: 960px;
  margin: 0 auto;
  padding: 32px 24px 64px;
}

/* ── Screens ──────────────────────────────────────────── */
.screen { display: none; }
.screen.active { display: block; }

/* ── Card ─────────────────────────────────────────────── */
.card {
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius-lg);
  padding: 28px;
  box-shadow: var(--shadow);
}
.card h2 {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 4px;
}
.card h3 {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 16px;
}
.subtitle {
  color: var(--gray-500);
  font-size: 14px;
  margin-bottom: 20px;
}

/* ── Drop Zone ────────────────────────────────────────── */
.drop-zone {
  border: 2px dashed var(--gray-300);
  border-radius: var(--radius-lg);
  padding: 40px 24px;
  text-align: center;
  cursor: pointer;
  transition: var(--transition);
  background: var(--gray-50);
}
.drop-zone:hover,
.drop-zone.dragover {
  border-color: var(--blue-600);
  background: var(--blue-50);
}
.drop-zone__icon { margin-bottom: 12px; }
.drop-zone p {
  font-size: 14px;
  color: var(--gray-500);
  margin-bottom: 8px;
}
.drop-zone__or {
  display: block;
  font-size: 13px;
  color: var(--gray-400);
  margin-bottom: 12px;
}

/* ── Upload state ─────────────────────────────────────── */
.drop-zone.uploading {
  pointer-events: none;
  border-color: var(--blue-600);
  background: var(--blue-50);
}
.drop-zone.uploading .drop-zone__icon svg path {
  stroke: var(--blue-600);
  animation: upload-bounce 1s ease infinite;
}
@keyframes upload-bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
}
.file-item--uploading {
  opacity: 0.7;
  border-style: dashed;
  border-color: var(--blue-600);
  background: var(--blue-50);
}
.file-item__icon--pulse {
  animation: icon-pulse 1.2s ease-in-out infinite;
}
@keyframes icon-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.4; }
}
.file-item__meta--loading {
  display: flex;
  align-items: center;
  gap: 6px;
  color: var(--blue-600);
}
.spinner-sm {
  display: inline-block;
  width: 12px;
  height: 12px;
  border: 2px solid var(--blue-100);
  border-top-color: var(--blue-600);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

/* ── Sample data ──────────────────────────────────────── */
.sample-data-section {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--gray-200);
}
.sample-data-section__label {
  font-size: 13px;
  color: var(--gray-500);
  font-weight: 500;
  margin-bottom: 10px;
}
.sample-datasets {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}
.sample-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 14px;
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius);
  font-family: inherit;
  font-size: 13px;
  color: var(--gray-700);
  cursor: pointer;
  transition: var(--transition);
}
.sample-chip:hover:not(:disabled) {
  border-color: var(--blue-600);
  background: var(--blue-50);
  color: var(--blue-600);
}
.sample-chip:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}
.sample-chip--loaded {
  background: var(--green-100);
  border-color: var(--green-600);
  color: var(--green-600);
}
.sample-chip--loading {
  border-color: var(--blue-600);
  background: var(--blue-50);
  color: var(--blue-600);
  animation: icon-pulse 1.2s ease-in-out infinite;
}
.sample-chip__name {
  font-weight: 500;
}
.sample-chip__meta {
  font-size: 11px;
  color: var(--gray-400);
  margin-left: 2px;
}
.sample-chip--loaded .sample-chip__meta { color: var(--green-600); opacity: 0.7; }
.sample-chip__check {
  font-size: 12px;
  font-weight: 700;
  color: var(--green-600);
}
.sample-datasets__empty {
  font-size: 13px;
  color: var(--gray-400);
}

/* ── Files List ───────────────────────────────────────── */
.files-list {
  margin-top: 16px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.file-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius);
  padding: 12px 16px;
  box-shadow: var(--shadow);
}
.file-item__info {
  display: flex;
  align-items: center;
  gap: 12px;
}
.file-item__icon {
  width: 36px;
  height: 36px;
  border-radius: var(--radius);
  background: var(--blue-50);
  color: var(--blue-600);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 700;
}
.file-item__name {
  font-weight: 500;
  font-size: 14px;
}
.file-item__meta {
  font-size: 12px;
  color: var(--gray-500);
}
.file-item__remove {
  background: none;
  border: none;
  cursor: pointer;
  color: var(--gray-400);
  padding: 4px;
  border-radius: 4px;
  transition: var(--transition);
}
.file-item__remove:hover { color: var(--red-600); background: var(--red-100); }

/* ── Preview Table ────────────────────────────────────── */
.preview-card {
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius-lg);
  margin-top: 16px;
  overflow: hidden;
  box-shadow: var(--shadow);
}
.preview-card__header {
  padding: 12px 16px;
  border-bottom: 1px solid var(--gray-200);
  font-weight: 600;
  font-size: 14px;
  background: var(--gray-50);
}
.preview-table-wrap {
  overflow-x: auto;
}
table.preview-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}
.preview-table th {
  background: var(--gray-50);
  padding: 8px 12px;
  text-align: left;
  font-weight: 600;
  color: var(--gray-700);
  border-bottom: 1px solid var(--gray-200);
  white-space: nowrap;
}
.preview-table td {
  padding: 6px 12px;
  border-bottom: 1px solid var(--gray-100);
  white-space: nowrap;
  color: var(--gray-700);
}
.preview-table tr:hover td { background: var(--blue-50); }

/* ── Files Summary ────────────────────────────────────── */
.files-summary {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 20px;
}
.files-summary__tag {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: var(--blue-50);
  color: var(--blue-600);
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 500;
}

/* ── Query Textarea ───────────────────────────────────── */
.query-area { margin-bottom: 16px; }
.query-textarea {
  width: 100%;
  border: 1px solid var(--gray-300);
  border-radius: var(--radius);
  padding: 14px 16px;
  font-family: inherit;
  font-size: 15px;
  line-height: 1.5;
  resize: vertical;
  transition: var(--transition);
  color: var(--gray-900);
}
.query-textarea:focus {
  outline: none;
  border-color: var(--blue-600);
  box-shadow: 0 0 0 3px var(--blue-100);
}

/* ── Prompt Chips ─────────────────────────────────────── */
.prompt-chips {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
  margin-bottom: 24px;
}
.prompt-chips__label {
  font-size: 13px;
  color: var(--gray-500);
  font-weight: 500;
}
.chip {
  background: var(--gray-100);
  border: 1px solid var(--gray-200);
  border-radius: 20px;
  padding: 5px 14px;
  font-size: 13px;
  font-family: inherit;
  cursor: pointer;
  transition: var(--transition);
  color: var(--gray-700);
}
.chip:hover {
  background: var(--blue-50);
  border-color: var(--blue-600);
  color: var(--blue-600);
}

/* ── Buttons ──────────────────────────────────────────── */
.btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 24px;
  border-radius: var(--radius);
  font-family: inherit;
  font-size: 14px;
  font-weight: 500;
  border: none;
  cursor: pointer;
  transition: var(--transition);
  text-decoration: none;
}
.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
.btn--primary {
  background: var(--blue-600);
  color: var(--white);
}
.btn--primary:hover:not(:disabled) { background: var(--blue-700); }
.btn--outline {
  background: var(--white);
  border: 1px solid var(--gray-300);
  color: var(--gray-700);
}
.btn--outline:hover:not(:disabled) { background: var(--gray-100); }
.btn--ghost {
  background: transparent;
  color: var(--blue-600);
}
.btn--ghost:hover:not(:disabled) { background: var(--blue-50); }
.btn--small {
  padding: 6px 14px;
  font-size: 13px;
}

.actions-row {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 12px;
  margin-top: 24px;
}

/* ── Status Bar ───────────────────────────────────────── */
.status-bar {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 20px;
  background: var(--blue-50);
  border: 1px solid var(--blue-100);
  border-radius: var(--radius);
  margin-bottom: 16px;
  font-size: 14px;
  color: var(--blue-600);
  font-weight: 500;
}
.status-bar.done {
  background: var(--green-100);
  border-color: #BBF7D0;
  color: var(--green-600);
}
.status-bar.error {
  background: var(--red-100);
  border-color: #FECACA;
  color: var(--red-600);
}
.spinner {
  width: 18px;
  height: 18px;
  border: 2.5px solid var(--blue-100);
  border-top-color: var(--blue-600);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}
.status-bar.done .spinner,
.status-bar.error .spinner { display: none; }
@keyframes spin { to { transform: rotate(360deg); } }

/* ── Code Panel ───────────────────────────────────────── */
.code-panel { overflow: hidden; }
.code-panel__header {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  color: var(--gray-700);
  padding: 0;
  list-style: none;
}
.code-panel__header::-webkit-details-marker { display: none; }
.code-panel__header::before {
  content: '\25B8';
  font-size: 12px;
  transition: transform var(--transition);
}
details[open] > .code-panel__header::before { transform: rotate(90deg); }
.code-status {
  font-size: 12px;
  font-weight: 500;
  padding: 2px 8px;
  border-radius: 4px;
  margin-left: auto;
}
.code-status.running {
  background: var(--yellow-100);
  color: var(--yellow-600);
}
.code-status.finished {
  background: var(--green-100);
  color: var(--green-600);
}
.code-block {
  margin-top: 16px;
  background: var(--gray-900);
  color: #E5E7EB;
  border-radius: var(--radius);
  padding: 16px;
  overflow-x: auto;
  font-size: 13px;
  line-height: 1.6;
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  max-height: 400px;
  overflow-y: auto;
  white-space: pre-wrap;
  word-break: break-word;
}

/* ── Text Output ──────────────────────────────────────── */
.text-output { margin-top: 16px; }
.text-content {
  font-size: 15px;
  line-height: 1.7;
  color: var(--gray-800);
}

/* ── Markdown Rendered Content ─────────────────────────── */
.text-content h1 { font-size: 22px; font-weight: 700; margin: 20px 0 8px; }
.text-content h2 { font-size: 18px; font-weight: 700; margin: 20px 0 8px; }
.text-content h3 { font-size: 16px; font-weight: 600; margin: 18px 0 6px; color: var(--gray-900); }
.text-content h4 { font-size: 15px; font-weight: 600; margin: 14px 0 4px; color: var(--gray-800); }
.text-content p { margin-bottom: 10px; }
.text-content p:last-child { margin-bottom: 0; }
.text-content hr {
  border: none;
  border-top: 1px solid var(--gray-200);
  margin: 16px 0;
}
.text-content ul,
.text-content ol {
  margin: 8px 0;
  padding-left: 24px;
}
.text-content ul { list-style: disc; }
.text-content li {
  margin-bottom: 4px;
  line-height: 1.6;
}
.text-content code {
  background: var(--gray-100);
  border: 1px solid var(--gray-200);
  border-radius: 4px;
  padding: 1px 6px;
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  font-size: 0.9em;
  color: var(--blue-700);
}
.text-content pre {
  background: var(--gray-900);
  color: #E5E7EB;
  border-radius: var(--radius);
  padding: 14px 16px;
  overflow-x: auto;
  font-size: 13px;
  line-height: 1.6;
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  margin: 12px 0;
}
.text-content pre code {
  background: none;
  border: none;
  padding: 0;
  color: inherit;
  font-size: inherit;
}
.text-content blockquote {
  border-left: 3px solid var(--blue-600);
  margin: 12px 0;
  padding: 8px 16px;
  background: var(--blue-50);
  border-radius: 0 var(--radius) var(--radius) 0;
  color: var(--gray-700);
}
.text-content blockquote p { margin-bottom: 4px; }
.text-content strong { font-weight: 600; }
.text-content table {
  width: 100%;
  border-collapse: collapse;
  margin: 12px 0;
  font-size: 14px;
}
.text-content th,
.text-content td {
  padding: 8px 12px;
  border: 1px solid var(--gray-200);
  text-align: left;
}
.text-content th {
  background: var(--gray-50);
  font-weight: 600;
}

/* ── Charts ───────────────────────────────────────────── */
.charts-section {
  margin-top: 24px;
}
.charts-section h3 {
  margin-bottom: 16px;
  font-size: 16px;
  font-weight: 600;
}
.charts-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 16px;
}
.chart-card {
  background: var(--white);
  border: 1px solid var(--gray-200);
  border-radius: var(--radius-lg);
  overflow: hidden;
  box-shadow: var(--shadow);
}
.chart-card img {
  width: 100%;
  height: auto;
  display: block;
}
.chart-card__footer {
  padding: 10px 16px;
  border-top: 1px solid var(--gray-200);
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 13px;
  color: var(--gray-500);
}

/* ── Export ────────────────────────────────────────────── */
.export-section { margin-top: 16px; }
.export-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}
.export-btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 20px;
  background: var(--white);
  border: 1px solid var(--gray-300);
  border-radius: var(--radius);
  font-family: inherit;
  font-size: 13px;
  font-weight: 500;
  color: var(--gray-700);
  cursor: pointer;
  transition: var(--transition);
  text-decoration: none;
}
.export-btn:hover {
  background: var(--gray-100);
  border-color: var(--gray-400);
}
.export-btn__icon {
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ── Responsive ───────────────────────────────────────── */
@media (max-width: 640px) {
  .main { padding: 16px 12px 48px; }
  .card { padding: 20px 16px; }
  .step__label { display: none; }
  .drop-zone { padding: 24px 16px; }
  .charts-grid { grid-template-columns: 1fr; }
}
